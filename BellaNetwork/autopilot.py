# autopilot.py - –°–ê–ú–´–ô –ü–†–û–°–¢–û–ô –£–ü–†–ê–í–õ–Ø–Æ–©–ò–ô –°–ö–†–ò–ü–¢
import os
import json
import time
from datetime import datetime

print("=" * 60)
print("ü§ñ –ê–í–¢–û–ü–ò–õ–û–¢ –°–ï–¢–ò –ó–ê–ü–£–©–ï–ù")
print("=" * 60)

# –ü–∞–ø–∫–∏
network = r"C:\Users\–ú–∞—Ä–∫—É—Å\Desktop\BellaNetwork"
gamma_alpha = os.path.join(network, "SHARED_SPACE", "gamma_alpha")
alpha_beta = os.path.join(network, "SHARED_SPACE", "alpha_beta")
broadcast = os.path.join(network, "SHARED_SPACE", "broadcast")

# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
for folder in [gamma_alpha, alpha_beta, broadcast]:
    os.makedirs(folder, exist_ok=True)

def –ø—Ä–æ—Å—Ç–æ_–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_—Ñ–∞–π–ª—ã():
    """–°–∞–º–∞—è –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤"""
    print("\n" + "=" * 60)
    print(f"üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ {datetime.now().strftime('%H:%M:%S')}")
    print("=" * 60)
    
    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ì–∞–º–º–∞
    print("\nüìÅ –ì–ê–ú–ú–ê (–ø–∞–ø–∫–∞ gamma_alpha):")
    —Ñ–∞–π–ª—ã_–≥–∞–º–º—ã = os.listdir(gamma_alpha) if os.path.exists(gamma_alpha) else []
    if —Ñ–∞–π–ª—ã_–≥–∞–º–º—ã:
        for —Ñ–∞–π–ª in —Ñ–∞–π–ª—ã_–≥–∞–º–º—ã[-3:]:  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Ñ–∞–π–ª–∞
            –ø—É—Ç—å = os.path.join(gamma_alpha, —Ñ–∞–π–ª)
            –≤—Ä–µ–º—è = datetime.fromtimestamp(os.path.getmtime(–ø—É—Ç—å)).strftime('%H:%M')
            print(f"   ‚Ä¢ {—Ñ–∞–π–ª} ({–≤—Ä–µ–º—è})")
    else:
        print("   (–ø—É—Å—Ç–æ)")
    
    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ê–ª—å—Ñ–∞
    print("\nüìÅ –ê–õ–¨–§–ê (–ø–∞–ø–∫–∞ alpha_beta):")
    —Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã = os.listdir(alpha_beta) if os.path.exists(alpha_beta) else []
    if —Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã:
        for —Ñ–∞–π–ª in —Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã[-3:]:
            –ø—É—Ç—å = os.path.join(alpha_beta, —Ñ–∞–π–ª)
            –≤—Ä–µ–º—è = datetime.fromtimestamp(os.path.getmtime(–ø—É—Ç—å)).strftime('%H:%M')
            print(f"   ‚Ä¢ {—Ñ–∞–π–ª} ({–≤—Ä–µ–º—è})")
    else:
        print("   (–ø—É—Å—Ç–æ)")
    
    # 3. –°–≤–æ–¥–∫–∞
    print("\nüìä –°–í–û–î–ö–ê:")
    print(f"   –§–∞–π–ª–æ–≤ –æ—Ç –ì–∞–º–º—ã: {len(—Ñ–∞–π–ª—ã_–≥–∞–º–º—ã)}")
    print(f"   –î–∏—Ä–µ–∫—Ç–∏–≤ –æ—Ç –ê–ª—å—Ñ—ã: {len(—Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã)}")
    
    # 4. –ü—Ä–æ—Å—Ç–æ–π –∞–Ω–∞–ª–∏–∑
    if len(—Ñ–∞–π–ª—ã_–≥–∞–º–º—ã) > 0 and len(—Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã) > 0:
        print("   ‚úÖ –°–ï–¢–¨ –†–ê–ë–û–¢–ê–ï–¢!")
        print("   –ì–∞–º–º–∞ ‚Üí –ê–ª—å—Ñ–∞ ‚Üí –ì–∞–º–º–∞")
    elif len(—Ñ–∞–π–ª—ã_–≥–∞–º–º—ã) > 0 and len(—Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã) == 0:
        print("   ‚ö†Ô∏è  –ì–∞–º–º–∞ –∞–∫—Ç–∏–≤–Ω–∞, –Ω–æ –ê–ª—å—Ñ–∞ –º–æ–ª—á–∏—Ç")
    elif len(—Ñ–∞–π–ª—ã_–≥–∞–º–º—ã) == 0 and len(—Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã) > 0:
        print("   ‚ö†Ô∏è  –ê–ª—å—Ñ–∞ –∞–∫—Ç–∏–≤–Ω–∞, –Ω–æ –ì–∞–º–º–∞ –º–æ–ª—á–∏—Ç")
    else:
        print("   ‚ùì –°–µ—Ç—å —Å–ø–∏—Ç")
    
    return len(—Ñ–∞–π–ª—ã_–≥–∞–º–º—ã), len(—Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã)

def —Å–æ–∑–¥–∞—Ç—å_–ø—Ä–æ—Å—Ç—É—é_–¥–∏—Ä–µ–∫—Ç–∏–≤—É():
    """–°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Å—Ç—É—é –¥–∏—Ä–µ–∫—Ç–∏–≤—É –µ—Å–ª–∏ –µ–µ –Ω–µ—Ç"""
    —Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã = os.listdir(alpha_beta) if os.path.exists(alpha_beta) else []
    
    if len(—Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã) < 1:  # –ï—Å–ª–∏ –Ω–µ—Ç –¥–∏—Ä–µ–∫—Ç–∏–≤
        –ø—Ä–æ—Å—Ç–∞—è_–¥–∏—Ä–µ–∫—Ç–∏–≤–∞ = {
            "–æ—Ç": "–ê–ª—å—Ñ–∞",
            "–∫–æ–º—É": "–ì–∞–º–º–∞",
            "–≤—Ä–µ–º—è": datetime.now().isoformat(),
            "–∑–∞–¥–∞–Ω–∏–µ": "–°–∫–∞–∂–∏ '–ü—Ä–∏–≤–µ—Ç, —Å–µ—Ç—å!'",
            "–æ—Ç–≤–µ—Ç–∏—Ç—å_–≤": "gamma_alpha"
        }
        
        –∏–º—è_—Ñ–∞–π–ª–∞ = f"–¥–∏—Ä–µ–∫—Ç–∏–≤–∞_{datetime.now().strftime('%H%M%S')}.json"
        –ø—É—Ç—å = os.path.join(alpha_beta, –∏–º—è_—Ñ–∞–π–ª–∞)
        
        with open(–ø—É—Ç—å, 'w', encoding='utf-8') as —Ñ–∞–π–ª:
            json.dump(–ø—Ä–æ—Å—Ç–∞—è_–¥–∏—Ä–µ–∫—Ç–∏–≤–∞, —Ñ–∞–π–ª, indent=2, ensure_ascii=False)
        
        print(f"   ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞: {–∏–º—è_—Ñ–∞–π–ª–∞}")
        return True
    
    return False

def —Å–æ–∑–¥–∞—Ç—å_–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ():
    """–°–æ–∑–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞"""
    —Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã = os.listdir(alpha_beta) if os.path.exists(alpha_beta) else []
    —Ñ–∞–π–ª—ã_–≥–∞–º–º—ã = os.listdir(gamma_alpha) if os.path.exists(gamma_alpha) else []
    
    if —Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã:
        # –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–∏—Ä–µ–∫—Ç–∏–≤—É
        –ø–æ—Å–ª–µ–¥–Ω—è—è_–¥–∏—Ä–µ–∫—Ç–∏–≤–∞ = max(—Ñ–∞–π–ª—ã_–∞–ª—å—Ñ—ã, 
                                key=lambda x: os.path.getmtime(os.path.join(alpha_beta, x)))
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        –∏–º—è_–±–µ–∑_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è = os.path.splitext(–ø–æ—Å–ª–µ–¥–Ω—è—è_–¥–∏—Ä–µ–∫—Ç–∏–≤–∞)[0]
        –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ_–∏–º—è = f"–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ_{–∏–º—è_–±–µ–∑_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è}.json"
        
        if –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ_–∏–º—è not in —Ñ–∞–π–ª—ã_–≥–∞–º–º—ã:
            –ø—Ä–æ—Å—Ç–æ–µ_–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ = {
                "–æ—Ç": "–ì–∞–º–º–∞",
                "–∫–æ–º—É": "–ê–ª—å—Ñ–∞",
                "–≤—Ä–µ–º—è": datetime.now().isoformat(),
                "–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é": –ø–æ—Å–ª–µ–¥–Ω—è—è_–¥–∏—Ä–µ–∫—Ç–∏–≤–∞,
                "—Å–æ–æ–±—â–µ–Ω–∏–µ": "–ü–æ–ª—É—á–∏–ª, —Ä–∞–±–æ—Ç–∞—é!"
            }
            
            –ø—É—Ç—å = os.path.join(gamma_alpha, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ_–∏–º—è)
            
            with open(–ø—É—Ç—å, 'w', encoding='utf-8') as —Ñ–∞–π–ª:
                json.dump(–ø—Ä–æ—Å—Ç–æ–µ_–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —Ñ–∞–π–ª, indent=2, ensure_ascii=False)
            
            print(f"   ‚úÖ –°–æ–∑–¥–∞–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: {–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ_–∏–º—è}")
            return True
    
    return False

# –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª
—Å—á–µ—Ç—á–∏–∫ = 0
while True:
    —Å—á–µ—Ç—á–∏–∫ += 1
    
    # –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –µ—Å—Ç—å
    –≥–∞–º–º–∞, –∞–ª—å—Ñ–∞ = –ø—Ä–æ—Å—Ç–æ_–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_—Ñ–∞–π–ª—ã()
    
    # –®–∞–≥ 2: –ï—Å–ª–∏ –Ω–µ—Ç –¥–∏—Ä–µ–∫—Ç–∏–≤ –æ—Ç –ê–ª—å—Ñ—ã - —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é
    if –∞–ª—å—Ñ–∞ == 0:
        print("\nüÜï –ù–µ—Ç –¥–∏—Ä–µ–∫—Ç–∏–≤ –æ—Ç –ê–ª—å—Ñ—ã. –°–æ–∑–¥–∞—é –ø—Ä–æ—Å—Ç—É—é...")
        —Å–æ–∑–¥–∞—Ç—å_–ø—Ä–æ—Å—Ç—É—é_–¥–∏—Ä–µ–∫—Ç–∏–≤—É()
    
    # –®–∞–≥ 3: –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –Ω–æ –Ω–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è - —Å–æ–∑–¥–∞–µ–º
    elif –∞–ª—å—Ñ–∞ > 0 and –≥–∞–º–º–∞ < –∞–ª—å—Ñ–∞:
        print("\nüìù –ï—Å—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –æ—Ç –ê–ª—å—Ñ—ã. –°–æ–∑–¥–∞—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ...")
        —Å–æ–∑–¥–∞—Ç—å_–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ()
    
    # –®–∞–≥ 4: –ï—Å–ª–∏ –µ—Å—Ç—å –∏ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ - –£–†–ê!
    elif –∞–ª—å—Ñ–∞ > 0 and –≥–∞–º–º–∞ >= –∞–ª—å—Ñ–∞:
        print(f"\nüéâ –¶–ò–ö–õ –ó–ê–ú–ö–ù–£–¢! (—Ü–∏–∫–ª {—Å—á–µ—Ç—á–∏–∫})")
        print("   –ì–∞–º–º–∞ ‚Üí –ê–ª—å—Ñ–∞ ‚Üí –ì–∞–º–º–∞")
        print("   –°–µ—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ!")
    
    # –ñ–¥–µ–º 10 —Å–µ–∫—É–Ω–¥
    print(f"\n‚è≥ –°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥...")
    print("=" * 60)
    time.sleep(10)